{% extends "base.jinja" %} 

{% block title %} Checkout | E-Com {% endblock%} 

{% block body %}

<!--
{% block nav %}
<li class="nav-item active">
    <a class="nav-link" href="{{ url_for('userController.logout') }}">Logout</a>
  </li>
{% endblock %}
-->

<br />
<p class="h2 text-center text-monospace p-4">Checkout</p>

<!-- 
<div class="text-left p-4">
  <p class="text-monospace pb-4 h3">Order Summary:</p>
  <p class="text-monospace">Total Price: &#x20B9;</p>
</div>  -->

<div class="card text-center mx-auto p-8" style="width: 50rem; height: 20rem;">
    <div class="card-body">

      <p class="text-monospace pb-4 h3">Order Summary:</p>
      <p class="text-monospace">Total Price: &#x20B9;</p>

    <form action="{{url_for('userController.checkout')}}" method="POST">
        <input type="hidden" name="shopping_order_id" value="21" />
    
        <br />
        <button id="rzp-button1" class="btn btn-success razorpay-payment-button">
          Checkout
        </button>
    
    
        <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
        <script>
          var options = {
            key: "rzp_test_WyK93y9mvps7SN", // Enter the Key ID generated from the Dashboard
            amount: "50000", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
            currency: "INR",
            name: "E-Com",
            description: "Payment",
            image: "static/assets/favicon-32x32.png",
            order_id: "2", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
            handler: function (response) {
              alert(response.razorpay_payment_id);
              alert(response.razorpay_order_id);
              alert(response.razorpay_signature);
            },
            prefill: {
              name: "Name",
              email: "email@example.com",
              contact: "9999999999",
            },
            notes: {
              address: "E-Com HQ,Kannur",
            },
            theme: {
              color: "#528FF0",
            },
          };
          var rzp1 = new Razorpay(options);
          rzp1.on("payment.failed", function (response) {
            alert(response.error.code);
            alert(response.error.description);
            alert(response.error.source);
            alert(response.error.step);
            alert(response.error.reason);
            alert(response.error.metadata.order_id);
            alert(response.error.metadata.payment_id);
          });
          document.getElementById("rzp-button1").onclick = function (e) {
            rzp1.open();
            e.preventDefault();
          };
        </script>
      </form>
    
    </div>
  </div>

<footer class="page-footer text-center fixed-bottom pb-3">
  <small>
    We are currently not offering cash on delivery(COD) on our website.</small
  >
</footer>

{% endblock %}
